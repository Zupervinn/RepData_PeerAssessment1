<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Vincent Phan" />

<meta name="date" content="2015-09-16" />

<title>Reproducible Research: Peer Assessment 1</title>

<script src="PA1_template_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="PA1_template_files/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="PA1_template_files/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="PA1_template_files/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="PA1_template_files/bootstrap-3.3.1/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="PA1_template_files/highlight/default.css"
      type="text/css" />
<script src="PA1_template_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Reproducible Research: Peer Assessment 1</h1>
<h4 class="author"><em>Vincent Phan</em></h4>
<h4 class="date"><em>September 16, 2015</em></h4>
</div>


<div id="loading-and-preprocessing-the-data" class="section level3">
<h3><strong>Loading and Preprocessing the data</strong></h3>
<pre class="r"><code>data &lt;- read.csv(&#39;activity.csv&#39;)
data &lt;- na.omit(data)
data$date &lt;- as.Date(data$date)
head(data)</code></pre>
<pre><code>##     steps       date interval
## 289     0 2012-10-02        0
## 290     0 2012-10-02        5
## 291     0 2012-10-02       10
## 292     0 2012-10-02       15
## 293     0 2012-10-02       20
## 294     0 2012-10-02       25</code></pre>
</div>
<div id="what-is-the-mean-total-number-of-steps-taken-per-day-10766.19-steps" class="section level3">
<h3><strong>What is the mean total number of steps taken per day? 10766.19 steps</strong></h3>
<pre class="r"><code>library(dplyr)</code></pre>
<div id="total-steps-per-day." class="section level4">
<h4>1.) Total Steps per day.</h4>
<pre class="r"><code>gbDate &lt;- group_by(data, date)
totalSteps &lt;- summarise(gbDate, total_steps=sum(steps))
as.data.frame(totalSteps)</code></pre>
<pre><code>##          date total_steps
## 1  2012-10-02         126
## 2  2012-10-03       11352
## 3  2012-10-04       12116
## 4  2012-10-05       13294
## 5  2012-10-06       15420
## 6  2012-10-07       11015
## 7  2012-10-09       12811
## 8  2012-10-10        9900
## 9  2012-10-11       10304
## 10 2012-10-12       17382
## 11 2012-10-13       12426
## 12 2012-10-14       15098
## 13 2012-10-15       10139
## 14 2012-10-16       15084
## 15 2012-10-17       13452
## 16 2012-10-18       10056
## 17 2012-10-19       11829
## 18 2012-10-20       10395
## 19 2012-10-21        8821
## 20 2012-10-22       13460
## 21 2012-10-23        8918
## 22 2012-10-24        8355
## 23 2012-10-25        2492
## 24 2012-10-26        6778
## 25 2012-10-27       10119
## 26 2012-10-28       11458
## 27 2012-10-29        5018
## 28 2012-10-30        9819
## 29 2012-10-31       15414
## 30 2012-11-02       10600
## 31 2012-11-03       10571
## 32 2012-11-05       10439
## 33 2012-11-06        8334
## 34 2012-11-07       12883
## 35 2012-11-08        3219
## 36 2012-11-11       12608
## 37 2012-11-12       10765
## 38 2012-11-13        7336
## 39 2012-11-15          41
## 40 2012-11-16        5441
## 41 2012-11-17       14339
## 42 2012-11-18       15110
## 43 2012-11-19        8841
## 44 2012-11-20        4472
## 45 2012-11-21       12787
## 46 2012-11-22       20427
## 47 2012-11-23       21194
## 48 2012-11-24       14478
## 49 2012-11-25       11834
## 50 2012-11-26       11162
## 51 2012-11-27       13646
## 52 2012-11-28       10183
## 53 2012-11-29        7047</code></pre>
</div>
<div id="histogram-of-total-steps-taken-each-day." class="section level4">
<h4>2.) Histogram of total steps taken each day.</h4>
<pre class="r"><code>hist(totalSteps$total_steps, xlab = &quot;Total steps&quot;, main =&quot;Histogram: Total Steps&quot;)
abline(v = mean(totalSteps$total_steps), col = &quot;green&quot;, lwd = 10)
abline(v = median(totalSteps$total_steps), col = &quot;red&quot;, lwd = 4)
legend(&quot;topright&quot;, c(&quot;mean=10766.19&quot;, &quot;median=10765&quot;), col=c(&quot;green&quot;, &quot;red&quot;), lty =c(1,1), lwd=2)</code></pre>
<p><img src="PA1_template_files/figure-html/unnamed-chunk-4-1.png" title="" alt="" width="672" /></p>
</div>
<div id="mean-and-median-of-total-steps-taken-per-day." class="section level4">
<h4>3.) Mean and median of total steps taken per day.</h4>
<pre class="r"><code>##mean
mean(totalSteps$total_steps)</code></pre>
<pre><code>## [1] 10766.19</code></pre>
<pre class="r"><code>##median
median(totalSteps$total_steps)</code></pre>
<pre><code>## [1] 10765</code></pre>
</div>
</div>
<div id="what-is-the-average-daily-activity-pattern" class="section level3">
<h3><strong>What is the average daily activity pattern?</strong></h3>
<div id="time-series-plot-using-ggplot2" class="section level4">
<h4>1.) Time series plot using ggplot2</h4>
<pre class="r"><code>library(ggplot2)</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.2.2</code></pre>
<pre class="r"><code>gbInterval &lt;- group_by(data, interval)
totalStepsInterval &lt;- summarize(gbInterval, average_steps = mean(steps))

intervalMaxSteps &lt;- filter(totalStepsInterval, average_steps == max(totalStepsInterval$average_steps))$interval
maxSteps &lt;- filter(totalStepsInterval, average_steps == max(totalStepsInterval$average_steps))$average_steps

ggplot(totalStepsInterval, aes(interval, average_steps)) + geom_line() + geom_vline(xintercept=intervalMaxSteps, color=&quot;blue&quot;) + annotate(&quot;text&quot;, x = 1230, y = 206.1698, label = &quot;V line = 5 Min interval MAX steps&quot;, color = &quot;blue&quot;, size = 3) + ylab(&quot;Average Steps&quot;) + xlab(&quot;Time Intervals&quot;) + labs(title =&quot;Time Series Plot(ggplot2)&quot;)</code></pre>
<p><img src="PA1_template_files/figure-html/unnamed-chunk-6-1.png" title="" alt="" width="672" /></p>
</div>
<div id="the-835-interval-contains-the-maximum-number-of-steps206.1698113." class="section level4">
<h4>2.) The 835 interval contains the maximum number of steps(206.1698113).</h4>
<pre class="r"><code>##Interval containing maximum number of steps
intervalMaxSteps &lt;- filter(totalStepsInterval, average_steps == max(totalStepsInterval$average_steps))$interval
intervalMaxSteps</code></pre>
<pre><code>## [1] 835</code></pre>
<pre class="r"><code>##Max number of steps
maxSteps &lt;- filter(totalStepsInterval, average_steps == max(totalStepsInterval$average_steps))$average_steps
maxSteps</code></pre>
<pre><code>## [1] 206.1698</code></pre>
</div>
</div>
<div id="imputing-missing-values-1.-calculating-reporting-total-number-of-missing-values-in-the-dataset." class="section level3">
<h3>**Imputing missing values ####1.) Calculating &amp; reporting total number of missing values in the dataset.</h3>
<pre class="r"><code>dataNA &lt;- read.csv(&quot;activity.csv&quot;)
summary(dataNA)</code></pre>
<pre><code>##      steps                date          interval     
##  Min.   :  0.00   2012-10-01:  288   Min.   :   0.0  
##  1st Qu.:  0.00   2012-10-02:  288   1st Qu.: 588.8  
##  Median :  0.00   2012-10-03:  288   Median :1177.5  
##  Mean   : 37.38   2012-10-04:  288   Mean   :1177.5  
##  3rd Qu.: 12.00   2012-10-05:  288   3rd Qu.:1766.2  
##  Max.   :806.00   2012-10-06:  288   Max.   :2355.0  
##  NA&#39;s   :2304     (Other)   :15840</code></pre>
<pre class="r"><code>## there are total of 2304 NA&#39;s</code></pre>
<div id="i-will-be-defining-mean-of-steps-for-each-5-minutes-interval-of-each-day.-for-missing-values-i-will-be-replacing" class="section level4">
<h4>2.) I will be defining mean of steps for each 5-minutes interval of each day. For missing values, I will be replacing</h4>
</div>
<div id="each-value-with-the-mean-of-steps-of-that-specific-5-minutes-interval." class="section level4">
<h4>each value with the mean of steps of that specific 5-minutes interval.</h4>
</div>
<div id="new-dataset-with-all-na-replaced" class="section level4">
<h4>3.) New dataset with all NA replaced</h4>
<pre class="r"><code># Setting up data: 1.) reading 2.) changing na to x 3.) arranging data by date
testOriginal &lt;- read.csv(&#39;activity.csv&#39;)
testOriginal$date &lt;- as.Date(testOriginal$date)
testOriginal[is.na(testOriginal)] &lt;- &quot;x&quot;
testOriginal &lt;- arrange(testOriginal, date)

# Splitting DF into 2 DFs. noNA only contains data without NA
noNA &lt;- filter(testOriginal, steps != &quot;x&quot;)
noNA$steps &lt;- as.numeric(noNA$steps)
# allNA contains only NA
allNA &lt;- filter(testOriginal, steps == &quot;x&quot;)

# Getting mean of steps in each unique interval
meanInterval &lt;- summarize(group_by(noNA, interval), average_steps=mean(steps))

# Combining average steps with allNA DF
newCol &lt;- cbind(meanInterval$average_steps, allNA)

# cleaning revised allNA 
newCol &lt;- select(newCol, -steps)
colnames(newCol)[1] &lt;- &quot;steps&quot;

# combining the 2 DF that was split making new DF with 
newDF &lt;- arrange(rbind(newCol, noNA), date)</code></pre>
<pre class="r"><code>print(newDF[1:10,])</code></pre>
<pre><code>##        steps       date interval
## 1  1.7169811 2012-10-01        0
## 2  0.3396226 2012-10-01        5
## 3  0.1320755 2012-10-01       10
## 4  0.1509434 2012-10-01       15
## 5  0.0754717 2012-10-01       20
## 6  2.0943396 2012-10-01       25
## 7  0.5283019 2012-10-01       30
## 8  0.8679245 2012-10-01       35
## 9  0.0000000 2012-10-01       40
## 10 1.4716981 2012-10-01       45</code></pre>
<pre class="r"><code>summary(newDF)</code></pre>
<pre><code>##      steps             date               interval     
##  Min.   :  0.00   Min.   :2012-10-01   Min.   :   0.0  
##  1st Qu.:  0.00   1st Qu.:2012-10-16   1st Qu.: 588.8  
##  Median :  0.00   Median :2012-10-31   Median :1177.5  
##  Mean   : 37.38   Mean   :2012-10-31   Mean   :1177.5  
##  3rd Qu.: 27.00   3rd Qu.:2012-11-15   3rd Qu.:1766.2  
##  Max.   :806.00   Max.   :2012-11-30   Max.   :2355.0</code></pre>
</div>
<div id="histogram-of-total-of-steps.-mean-median-of-total-steps-taken-per-day." class="section level4">
<h4>4.) Histogram of total # of steps. Mean &amp; Median of total steps taken per day.</h4>
<ul>
<li>Yes, value is the same for Mean</li>
<li>No, median is now 10766.19 instead of 10765.</li>
<li>There are little to no impact after imputing missing data</li>
</ul>
<pre class="r"><code>NDtotalSteps &lt;- summarize(group_by(newDF, date), total_steps = sum(steps))
as.data.frame(NDtotalSteps)</code></pre>
<pre><code>##          date total_steps
## 1  2012-10-01    10766.19
## 2  2012-10-02      126.00
## 3  2012-10-03    11352.00
## 4  2012-10-04    12116.00
## 5  2012-10-05    13294.00
## 6  2012-10-06    15420.00
## 7  2012-10-07    11015.00
## 8  2012-10-08    10766.19
## 9  2012-10-09    12811.00
## 10 2012-10-10     9900.00
## 11 2012-10-11    10304.00
## 12 2012-10-12    17382.00
## 13 2012-10-13    12426.00
## 14 2012-10-14    15098.00
## 15 2012-10-15    10139.00
## 16 2012-10-16    15084.00
## 17 2012-10-17    13452.00
## 18 2012-10-18    10056.00
## 19 2012-10-19    11829.00
## 20 2012-10-20    10395.00
## 21 2012-10-21     8821.00
## 22 2012-10-22    13460.00
## 23 2012-10-23     8918.00
## 24 2012-10-24     8355.00
## 25 2012-10-25     2492.00
## 26 2012-10-26     6778.00
## 27 2012-10-27    10119.00
## 28 2012-10-28    11458.00
## 29 2012-10-29     5018.00
## 30 2012-10-30     9819.00
## 31 2012-10-31    15414.00
## 32 2012-11-01    10766.19
## 33 2012-11-02    10600.00
## 34 2012-11-03    10571.00
## 35 2012-11-04    10766.19
## 36 2012-11-05    10439.00
## 37 2012-11-06     8334.00
## 38 2012-11-07    12883.00
## 39 2012-11-08     3219.00
## 40 2012-11-09    10766.19
## 41 2012-11-10    10766.19
## 42 2012-11-11    12608.00
## 43 2012-11-12    10765.00
## 44 2012-11-13     7336.00
## 45 2012-11-14    10766.19
## 46 2012-11-15       41.00
## 47 2012-11-16     5441.00
## 48 2012-11-17    14339.00
## 49 2012-11-18    15110.00
## 50 2012-11-19     8841.00
## 51 2012-11-20     4472.00
## 52 2012-11-21    12787.00
## 53 2012-11-22    20427.00
## 54 2012-11-23    21194.00
## 55 2012-11-24    14478.00
## 56 2012-11-25    11834.00
## 57 2012-11-26    11162.00
## 58 2012-11-27    13646.00
## 59 2012-11-28    10183.00
## 60 2012-11-29     7047.00
## 61 2012-11-30    10766.19</code></pre>
<pre class="r"><code>par(mfcol = c(1,2))

# new hist
hist(NDtotalSteps$total_steps, xlab = &quot;Total steps&quot;, main =&quot;Histogram: NEW Total Steps&quot;)
abline(v = mean(NDtotalSteps$total_steps), col = &quot;green&quot;, lwd = 10)
abline(v = median(NDtotalSteps$total_steps), col = &quot;red&quot;, lwd = 4)
legend(&quot;topright&quot;, c(&quot;mean=10766.19&quot;, &quot;median=10766.19&quot;), col=c(&quot;green&quot;, &quot;red&quot;), lty =c(1,1), lwd=2, cex=.6)

# Original hist
hist(totalSteps$total_steps, xlab = &quot;Total steps&quot;, main =&quot;Histogram: Origina Total Steps&quot;)
abline(v = mean(totalSteps$total_steps), col = &quot;green&quot;, lwd = 10)
abline(v = median(totalSteps$total_steps), col = &quot;red&quot;, lwd = 4)
legend(&quot;topright&quot;, c(&quot;mean=10766.19&quot;, &quot;median=10765&quot;), col=c(&quot;green&quot;, &quot;red&quot;), lty =c(1,1), lwd=2, cex = .60)</code></pre>
<p><img src="PA1_template_files/figure-html/unnamed-chunk-11-1.png" title="" alt="" width="672" /></p>
<pre class="r"><code># Mean of total steps.
mean(NDtotalSteps$total_steps)</code></pre>
<pre><code>## [1] 10766.19</code></pre>
<pre class="r"><code># Median of total steps.
median(NDtotalSteps$total_steps)</code></pre>
<pre><code>## [1] 10766.19</code></pre>
<pre class="r"><code>length(NDtotalSteps$total_steps)</code></pre>
<pre><code>## [1] 61</code></pre>
<pre class="r"><code>length(totalSteps$total_steps)</code></pre>
<pre><code>## [1] 53</code></pre>
</div>
</div>
<div id="are-there-differences-in-activity-patterns-between-weekdays-and-weekends-yes" class="section level3">
<h3>Are there differences in activity patterns between weekdays and weekends? YES</h3>
<pre class="r"><code>## Adding day to newDF
addDay &lt;- data.frame(steps=newDF$steps, date=newDF$date, day=weekdays(newDF$date), interval=newDF$interval)
addDay$day &lt;- as.character(addDay$day)
weekday &lt;- c(&quot;Monday&quot;,&quot;Tuesday&quot;,&quot;Wednesday&quot;,&quot;Thursday&quot;,&quot;Friday&quot;)
weekend &lt;- c(&quot;Saturday&quot;, &quot;Sunday&quot;)

onlyWeekend &lt;- filter(addDay, day == &quot;Sunday&quot; | day == &quot;Saturday&quot;)
onlyWeekday &lt;- filter(addDay, day == &quot;Monday&quot; | day == &quot;Tuesday&quot; | day == &quot;Wednesday&quot; | day ==&quot;Thursday&quot;|day ==&quot;Friday&quot;)

averageStepsWeekend &lt;- summarize(group_by(onlyWeekend, interval), average_steps=mean(steps))
averageStepsWeekend$Day &lt;- &quot;Weekend&quot;

averageStepsWeekday &lt;- summarize(group_by(onlyWeekday, interval), average_steps=mean(steps))
averageStepsWeekday$Day &lt;- &quot;Weekday&quot;

averageDay &lt;- rbind(averageStepsWeekend, averageStepsWeekday)

library(lattice)

xyplot(average_steps~interval|Day, data = averageDay, layout=c(1,2), type=&quot;l&quot;, ylab=&quot;Number of steps&quot;, xlab=&quot;Interval&quot;)</code></pre>
<p><img src="PA1_template_files/figure-html/unnamed-chunk-13-1.png" title="" alt="" width="672" /></p>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
